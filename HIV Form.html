<!-- HIV FORM -->

<htmlform>
<script type="text/javascript">

        //Function to check if an element exists (useful for debugging)
        $j.fn.exists = function(){
            return this.length > 0 ? this : false;
        }

        $j(document).ready(function(){

    $j('#44-addEntry').remove();
    $j('#1-removeEntry').remove();
	
    $j('#101-removeEntry').remove();
    $j('#401-removeEntry').remove();
    $j('#410-addEntry').remove();

    displayRows(addedDiagnosisCount,"addedDiagnosisCount.value",1);
    displayRows(addedDiagCount,"addedDiagCount.value",401);
    displayRows(addedReferralsCount,"addedReferralsCount.value",101);
    displayRows(addedReferralsReceivedCount,"addedReferralsReceivedCount.value",601);
$j('button.addEntry').live("click", function(){

        var rowNumber = parseFloat(this.id);

        var listValueString = '-list.value';
        if (rowNumber > 44) {
            listValueString = '-list.value_1';
        }

        valuestring = parseFloat(this.id) + listValueString;
        //the second element of this or fails so if it makes it through the first
        //the form crashes - left it here in case there's a case where this is nec
        if (getValue(valuestring) != '' )
        {
            var correctedAddButtonId = parseFloat(this.id) + 1;

            // determine the right count to update
            if( (this.id > 600) ) {
                valuestring = 'addedReferralsReceivedCount.value';
            } else if ((this.id > 500)) {
                valuestring = 'addedRadCount.value';
            } else if ((this.id > 400)) {
                valuestring = 'addedDiagCount.value';
            } else if ((this.id > 300)) {
                valuestring = 'addedUsCount.value';
            } else if (this.id > 200) {
                valuestring='addedLabsCount.value';
            } else if ((this.id > 100)) {
                valuestring = 'addedReferralsCount.value';
            } else if (this.id > 44) {
                valuestring = 'addedSurgeryCount.value';
            } else {
                valuestring = 'addedDiagnosisCount.value';
            };

            //once we have the right count string, get the current count and increment if we have added
            var currentCount = getValue(valuestring);
            if (correctedAddButtonId>currentCount){
                currentCount = correctedAddButtonId;
                setValue(valuestring, currentCount);
            };

             // turn on the next button, toggle off the previous and turn on the remove button on this one
             var contentAddId = "#" + correctedAddButtonId + "-toggleContainer";
             $j(contentAddId).toggle(true);
             $j('#' + this.id).toggle(false);
             $j('#' + parseFloat(this.id) + '-removeEntry').toggle(false);
        }

         return false;
     });

    $j('button.removeEntry').live("click", function(){
        var correctedRemoveButtonId = parseFloat(this.id) - 1;

        // update the right count - 1 - 44 reportable diagnoses 45 -54 surgery

        if (correctedRemoveButtonId > 600) {
            setValue('addedReferralsReceivedCount.value', Number(getValue('addedReferralsReceivedCount.value')) -1);

        }  else   if (correctedRemoveButtonId > 500) {
            setValue('addedRadCount.value', Number(getValue('addedRadCount.value')) -1);

        }  else   if (correctedRemoveButtonId > 400) {
            setValue('addedDiagCount.value', Number(getValue('addedDiagCount.value')) -1);

        }  else   if (correctedRemoveButtonId > 300) {
            setValue('addedUsCount.value', Number(getValue('addedUsCount.value')) -1);

        } else   if (correctedRemoveButtonId > 200) {
            setValue('addedLabsCount.value', Number(getValue('addedLabsCount.value')) -1);

        } else  if (correctedRemoveButtonId > 100) {
            setValue('addedReferralsCount.value', Number(getValue('addedReferralsCount.value')) -1);

        } else if (correctedRemoveButtonId > 44) {
            setValue('addedSurgeryCount.value', Number(getValue('addedSurgeryCount.value')) - 1);

        } else {
            setValue('addedDiagnosisCount.value', Number(getValue('addedDiagnosisCount.value')) - 1);
        };
        var contentAddId = "#" + parseFloat(this.id) + "-toggleContainer";
        $j(contentAddId).toggle(false);
        $j( ':input:not(:button)', contentAddId).val([]);

        $j('#' + correctedRemoveButtonId + '-addEntry').toggle(true);
        $j('#' + correctedRemoveButtonId + '-removeEntry').toggle(true);
        return false;
    });
	
	beforeSubmit.push(function() {
			setValue('addedDiagnosisCount.value', removeBlanks(1,44,"-list.value",1,false));
			setValue('addedDiagCount.value', removeBlanks(401,10,"-list.value",1,false));
			setValue('addedReferralsCount.value', removeBlanks(101,10,"-list.value",2,false));
			setValue('addedReferralsReceivedCount.value', removeBlanks(601,10,"-list.value",2,false));
			
			var value = getValue("addedReferralsCount.value");
			if (value=='' || value==null)
				value = "0";
			if (value == "0")
			{
				alert ("Referrals Made cannot be empty. Please enter a value to proceed.");
				return false;	
			}
		
			var value = getValue("addedDiagnosisCount.value");
			if (value=='' || value==null)
				value = "0";
			if (value == "0")
			{
				//scrollFieldIntoView('REPDIAG_1');
				alert ("Reportable Diagnosis cannot be empty. Please enter a value to proceed.");
				return false;	
			}
			
			return true;
		});
		
         executeJavascriptStuffForPage();
         setupNestedOptions();
         setupRequiredFields();
        });
        function setupRequiredFields()
        {
            beforeSubmit.push(function(){
                if($j(".arv_side_effect_trigger").find('input:checked').length>0)
                {
                    if($j('.arv_side_effect_required').find('input:checked').length==0)
                    {
                        alert('Please select at least one of the ARV Side Effects.');
                        return false;   
                    }    
                }
                if($j(".arv_eligibility_trigger").find('input:checked').length>0)
                {
                    if($j('.arv_eligibility_required').find('input:checked').length==0)
                    {
                        alert('Please select at least one of the ARV Eligibility Criteria.');
                        return false;   
                    }    
                }
                var requiredFieldIds=["arv_plan","pcp_prophylaxis_plan","tb_status","tuberculosis_prophylaxis_plan","hiv_risk_factor","pwp_counselling_provided","given_condoms","preventative_counselling","sti_screening","hiv_status_disclosure","client_partner_onsite","hiv_transmission_prevention"];
                for(var i=0;i!=requiredFieldIds.length;i++)
                {
                    var fieldId=requiredFieldIds[i];
                    if(isEmptyField(fieldId))
                    {
                        scrollFieldIntoView(fieldId);
                        alert ("Please make sure to fill in all required fields.");
                        return false;
                    }
                }
                return true;
            });
        }
        function isEmptyField(id)
        {
            var value=getValue(id+".value");
            if (value=='' || value==null)
                return true;
            return false;
        }
        function scrollFieldIntoView(fieldId)
        {
            var bodyRect = document.body.getBoundingClientRect()
            var elemRect = $j('#'+fieldId)[0].getBoundingClientRect()
            var offset   = elemRect.top - bodyRect.top;
            window.scrollTo(0,offset-50);
        }
        function setupNestedOptions()
        {
            $j(".enableDisable").each(function()
            {
                var group = $j(this);
                function disableFn()
                {
                    group.children("#disabled").fadeTo(250,0.33);
                    group.children("#disabled").find(":checkbox").attr("checked",false); //uncheck
                    group.children("#disabled").find("input[type$='text']").val("");
                    group.children("#disabled").find("textarea").val("");
                    group.children("#disabled").find("select").val(0);
                    group.children("#disabled").find("input").attr("disabled",true);  //disable
                    group.children("#disabled").find("textarea").attr("disabled",true);
                    group.children("#disabled").find("select").attr("disabled",true);
                }
                function enableFn()
                {
                    group.children("#disabled").fadeTo(250,1);
                    group.children("#disabled").find("input").attr("disabled",false);
                    group.children("#disabled").find("select").attr("disabled",false);
                    group.children("#disabled").find("textarea").attr("disabled",false);
                }
                <ifMode mode="ENTER" include="true">
                disableFn();
                </ifMode>

                $j(this).children("#trigger").find(":checkbox:first").change(function()
                {
                    var checked = $j(this).attr("checked");
                    if(checked == true)
                    {
                        enableFn();
                    }
                    else
                    {
                        disableFn();
                    }
                });
            });

            $j(".checkboxGroup").each(function(){
                var group = $j(this);
                var uncheckAll = function(){
                    group.find("input[type$='checkbox']").attr("checked",false);
                    group.find("input[type$='checkbox']").change();
                }
                var uncheckRadioAndAll = function(){
                    group.find("#checkboxAll,#checkboxRadio").find("input[type$='checkbox']").attr("checked",false);
                    group.find("#checkboxAll,#checkboxRadio").find("input[type$='checkbox']").change();
                }

                group.find("#checkboxAll").find("input").click(
                    function(){
                        var flip;
                        var checked = $j(this).siblings(":checkbox:first").attr("checked");
                        if($j(this).attr("name") == $j(this).parents("#checkboxAll:first").find(":checkbox:first").attr("name")){
                            checked = $j(this).attr("checked");
                            flip = checked;
                        }else{
                            flip = !checked;
                        }
                          if($j(this).attr("type") == "text") if(flip == false) flip = !flip; // this is so the user doesn't go to check the checkbox, then uncheck it when they
                          uncheckAll();
                          $j(this).parents("#checkboxAll:first").find(":checkbox").attr("checked",flip);
                          $j(this).parents("#checkboxAll:first").find(":checkbox").change();
                      }
                      );

                group.find("#checkboxRadio").find("input[type$='checkbox']").click(function(){
                    uncheckAll();
                    $j(this).siblings("input[type$='checkbox']").attr("checked",false);
                    $j(this).attr("checked",true);
                    $j(this).change();
                });

                group.find("#checkboxCheckbox").click(
                    function(){
                        uncheckRadioAndAll();
                    }
                    );
            }); 
        }
        function executeJavascriptStuffForPage() {
            <!--alert("Page Loaded");-->


            //Register a Hide/Unhide event for HIV Exposure Dropdown - Other Box
            $j("#methodOfHIVExposure select").change(
                function(){
                    toggleEnablementOfControls(this ,"5622", ["#methodOfHIVExposureOtherRow", "#methodOfHIVExposureOther textarea"]);
                }
            );


            //Register a Disable event for PCP Plan dropdown selection.
            $j("#pcp_prophylaxis_plan select").change(
                function(){
                    toggleEnablementOfControls(this ,"1260",
                    ["#reasonProphylaxixStoppedDropdown_row","#reasonProphylaxixStoppedDropdown select",
                    "#reasonProphylaxisStoppedRow","#reasonProphylaxisStopped textarea"]);
                }
            );
			
			//Register a Disable event for Tuberculosis Prophylaxis Plan dropdown selection. 
            $j("#tuberculosis_prophylaxis_plan select").change(
                function(){
                    toggleEnablementOfControls(this ,"1260",
                    ["#reasonTuberculosisProphylaxisStoppedDropdown_row","#reason_tb_proph_stopped select"]);
                }
            );

            //Register a Disable event for PCP Prophylaxis Stopped Dropdown - Reason Box
            $j("#reasonProphylaxixStoppedDropdown select").change(
                function(){
                    toggleEnablementOfControls(this ,"5622", ["#reasonProphylaxisStoppedRow","#reasonProphylaxisStopped textarea"]);
                }
            );


            //Register a Disable event for Family Planning or Contraceptive Method (On Checkbox)
            $j("#using_fp_or_contraceptive :checkbox").click(toggleContraceptiveCheckboxes);
        }


        function toggleContraceptiveCheckboxes(){
            var checked = $j(this).is(':checked');
            if(checked){
                enableAllControls(["#contraceptive_row1","#contraceptive_row2","#contraceptive_row3","#contraceptive_row4", "#contraceptive_row5"]);
                enableAllControls(["#contraceptive_row1 ","#contraceptive_row2 :checkbox","#contraceptive_row3 :checkbox","#contraceptive_row4 :checkbox", "#contraceptive_row5 textarea"]);

            }else{
                disableAllControls(["#contraceptive_row1","#contraceptive_row2","#contraceptive_row3","#contraceptive_row4", "#contraceptive_row5"]);
                disableAllControls(["#contraceptive_row1 ","#contraceptive_row2 :checkbox","#contraceptive_row3 :checkbox","#contraceptive_row4 :checkbox", "#contraceptive_row5 textarea"]);
            }

        }


        /**
         * Generic function to disable controls on selection of certain dropdown value.
         * The controls can be passed as jquery selector strings in selectorArray
         */
        function toggleEnablementOfControls(dropdown, valToShowWith, selectorArray) {
            var selectedOption = $j(dropdown).val();
            if(selectedOption === valToShowWith){
                enableAllControls(selectorArray);
            } else {
                disableAllControls(selectorArray);
            }
        }

        /**
         * Generic function to enable all controls and un-fade them. The passed array holds jQuery selectors
         */
        function enableAllControls(selectorArray){
            $j.each(selectorArray, function( index, selector ) {
                  $j(selector).removeAttr("disabled");
                  $j(selector).fadeTo(250,1);
            });
        }

        /**
         * Generic function to disable all controls and fade them. The passed array holds jQuery selectors
         */

        function disableAllControls(selectorArray){
            $j.each(selectorArray, function( index, selector ) {
                      $j(selector).attr('disabled', true);
                      $j(selector).fadeTo(250,0.33);
                });
        }
        function isBlank(listValueString,numListElements,allBlank)
{
    var numCheck = 1;
    if (allBlank) {numCheck = numListElements};
    var thisListValueString = listValueString;
    if (numListElements > 1) {
        thisListValueString = thisListValueString + "_1";
    };
    var i = 1;
    while (numCheck >= i) {
        if (getValue(thisListValueString) != '' ) {
            return false;
        };
        i++;
        thisListValueString = listValueString + "_" + i;
    };
    return true;
};

function removeBlanks(startRow,numberRows,listValueString,numListElements,allBlank)
{
    //
    //function shuffles all non-blank rows from array item start to start+number-1 to the beginning
    // startRow is the first row in the array
    // numberRows is the number of rows in this block
    // numListElements is the number of elements in each row
    // if numListElements is more than one allBlank TRUE means to ensure all elements are blank otherwise checks just the first
    //

    var i = startRow;
    var nonBlankCount = 0;
    var lastRow = startRow +numberRows - 1;
    var baseListValueString = listValueString;
    if (numListElements > 1) {
        baseListValueString = baseListValueString + "_1";
    };

    while (lastRow >= i) {

          // keep going if nonblank
          if (!isBlank((i+listValueString),numListElements,allBlank)) {
            i++;
            nonBlankCount ++;
          } else {
              // found blank line, find next non-blank
              var j = i + 1;
              while ((lastRow >= j) &amp;&amp; (isBlank((j+listValueString),numListElements,allBlank))) {
                j++;
              };
                 // if we have found a nonblank, move the nonblanks down
                 var newStart = j;
                 while (!isBlank((j+listValueString),numListElements,allBlank) &amp;&amp; (lastRow >= j)) {
                     //move all of the elements in this row
                     for (k=1; numListElements >=k; k++) {
                        var thisListElement = listValueString + "_" + k;
                        if ( (k==1) &amp;&amp; (numListElements == 1) ) {
                            thisListElement = listValueString;
                        };
                        var moveValuestring = getValue(j + thisListElement);
                        setValue(i + thisListElement, moveValuestring);
                        setValue(j + thisListElement,'');
                     };
                     nonBlankCount++;
                     i++;
                     j++;
                 };
                 if (j > lastRow) {
                    i = j;
                 };
             };
         };
         return nonBlankCount;
};   //end function

function displayRows(countConcept,countConceptValue,startRow)
{
    //
    // find the count of the number of surgeries that exist
    //
    var addedCount = $j(countConcept).html();
    var regex = /(&lt;([^>]+)>)/ig;
    if (addedCount != null){
        var addedInt = addedCount.replace(regex, "");
        addedCount = Number(addedInt);
    };
    //set to the first if there are none added so far
    if (addedCount == null || addedCount == '' || addedCount== 0){
            // if we are in edit mode need to get count a different way
            addedCount = getValue(countConceptValue);
            if (addedCount == 0) {
                addedCount = 1;
            };
        };
    // make sure all of the ones we have display
    for(i=1; addedCount>=i; i++){
        var rowNumber = startRow + i - 1;
        var dynString = "#" + rowNumber + "-toggleContainer";
        $j(dynString).show();
    };

    //
    // click for the number of entries that exist so that they show up
    //
    for(i=1; addedCount>i; i++){
        rowNumber = startRow + i - 1;
        dynString = "#" + rowNumber + "-addEntry";
        $j(dynString).click();
    };
}


    </script>

<macros>
    headerColor = #009d8e
    fontOnHeaderColor = white
    majorSectionColor = #FFFF99
</macros>

<style>

    .question {
        background-color: #FAEBD7;
        color: #DC143C;
        font-style: italic;
        font-size:12px;
    }

    .majorSection {
    background-color: $majorSectionColor;
    display: block;
    }

    .info-message {
    font-weight: italics;
    color: blue
    }

    /*
    Helps bolding the label of a checkbox or
    radio button when it is selected
    */
    :checked + label {

    font-weight: bold;
    }

    td.spaced-out-td {
    border: none;
    width: auto;
    padding-right: 10px;
    }

    .section {
    border: 1px solid $headerColor;
    padding: 2px;
    text-align: left;
    margin-bottom: 1em;
    }
    .sectionHeader {
    background-color: $headerColor;
    color: $fontOnHeaderColor;
    display: block;
    padding: 2px;
    font-weight: bold;
    }

    .labelCol {
    vertical-align: top;
    font-weight: bold;
    }

    .secondary {
    padding-left: 10px;
    }
    .baseline-aligned td.label {
    text-align: right;
    }
    .right {
    float: right;
    }
    .karnofsky tr{
    width: 100%;
    }
    .karnofsky td{
    width: 50%;
    }
    .inner-table {
    width: 100%
    }
    .checkboxGroup {
    width: 100%;
    }
    .two-wide {
    width: 100%;
    }
    .two-wide tr {
    width: 100%;
    }
    .two-wide td {
    padding-left: 5px;
    padding-bottom: 5px;
    width: 50%;
    vertical-align: top;
    border: 1px solid $headerColor;
    }
    .two-wide td.enableDisable {
    border: none;
    width: auto;
    padding-right: 2px;
    }
    .two-wide td.nested-td {
    border: none;
    width: auto;
    padding-right: 2px;
    }
    .two-wide td.nested-label {
    border: none;
    width: auto;
    padding-right: 2px;
    text-align: right;
    }
    #three-wide {
    width: 100%
    }
    #three-wide tr {
    width: 100%;
    }
    #three-wide td {
    padding-left: 5px;
    width: 33%;
    vertical-align: top;
    border: 1px solid $headerColor;
    }


</style>

<h2>HIV Form (v1.0)</h2>


<section headerLabel="Contents">
    <ol>
        <li><a href="#S1"> Encounter Details </a></li>
        <li><a href="#S2"> Demographics </a></li>
        <li><a href="#S3"> Method of HIV Exposure </a></li>
        <li><a href="#S4"> Pregnancy </a></li>
        <li><a href="#S5"> Presenting Complaint </a></li>
        <li><a href="#S6"> HIV Lab Results </a></li>
        <li><a href="#S7"> Vitals </a></li>
        <li><a href="#S8"> ARV Side-Effects </a></li>
        <li><a href="#S9"> ARV Adherence </a></li>
        <li><a href="#S10"> ARV Plan </a></li>
        <li><a href="#S11"> PCP Prophylaxis </a></li>
        <li><a href="#S12"> Cryptococcal Prophylaxis</a></li>
        <li><a href="#S13"> Tuberculosis</a></li>
        <li><a href="#S14"> TB Screening</a></li>
        <li><a href="#S15"> TB Prophylaxis</a></li>
        <li><a href="#S16"> Family Planning</a></li>
        <li><a href="#S17"> At-Risk Population</a></li>
        <li><a href="#S18"> PWP Services</a></li>
        <li><a href="#Referrals"> Referrals</a></li>
        <li><a href="#S19"> Diagnosis</a></li>
    </ol>
</section>

      <span id="S1">
        <section headerLabel="1. Encounter Details">
            <script type="text/javascript">
            $j(document).ready(function(){
                <ifMode mode="ENTER">
                    $j("#date_div_showed").append($j("#date_div_hidden").find("input").clone().val());
                    $j("#location_div_showed").append($j("#location_div_hidden").find("select option:selected").clone().text());
                    $j("#provider_div_showed").append($j("#provider_div_hidden").find("select option:selected").clone().text());
                </ifMode>
                <ifMode mode="EDIT">
                    $j("#date_div_showed").append($j("#date_div_hidden").find("input").clone().val());
                    $j("#location_div_showed").append($j("#location_div_hidden").find("select option:selected").clone().text());
                    $j("#provider_div_showed").append($j("#provider_div_hidden").find("select option:selected").clone().text());
                </ifMode>
                <ifMode mode="VIEW">
                    $j("#date_div_showed").append($j("#date_div_hidden").find("span").clone().text());
                    $j("#location_div_showed").append($j("#location_div_hidden").find("span").clone().text());
                    $j("#provider_div_showed").append($j("#provider_div_hidden").find("span").clone().text());
                </ifMode>
                $j("#location_div_hidden").hide();
                $j("#provider_div_hidden").hide();
                $j("#date_div_hidden").hide();
                //$j("#table_encounterDetails").find("input").attr("disabled",true);
                //$j("#table_encounterDetails").find("select").attr("disabled",true);
            });
        </script>
            <table class="baseline-aligned">
                <tr>
                    <td class="label">Date:</td>
                    <td>
                        <div id="date_div_hidden">
                            <encounterDate default="now" showTime="true"/>
                        </div>
                        <div id="date_div_showed">
                        </div>
                    </td>
                </tr>
                <tr>
                    <td class="label">Location:</td>
                    <td>
                        <div id="location_div_hidden">
                            <encounterLocation default="UserProperty:defaultLocation" order="UserProperty:defaultLocation"/>
                        </div>
                        <div id="location_div_showed">
                        </div>
                    </td>
                </tr>
                <tr>
                    <td class="label">Provider:</td>
                    <td>
                        <div id="provider_div_hidden">
                            <encounterProvider default="currentUser" order="currentUser"/>
                        </div>
                        <div id="provider_div_showed">
                        </div>
                    </td>
                </tr>
            </table>
            <h4>Referrals Received:</h4>
            <table>
                <tr>
                    <td>
                        <repeat>
                            <template>
                                <table>
                                    <tr id="{n}-toggleContainer" style="display:none;">
                                        <td class="nested-td">
                                            <obs id="{n}-list" field="REFER_{n}" conceptId="161257" style="dropdown"/>
                                            Location:
                                            <obs id="{n}-list" field="REFER_loc{n}" conceptId = "161257" answerClasses="KMRI_Locations" style="dropdown" showCommentField="true" />
                                        </td>
                                        <td class="nested-td">
                                            <button id="{n}-addEntry" class="addEntry">Add</button>
                                            <button id="{n}-removeEntry" class="removeEntry">Remove</button>
                                        </td>
                                    </tr>
                                </table>
                            </template>
                            <render n="601"/>
                            <render n="602"/>
                            <render n="603"/>
                            <render n="604"/>
                            <render n="605"/>
                            <render n="606"/>
                            <render n="607"/>
                            <render n="608"/>
                            <render n="609"/>
                            <render n="610"/>
                        </repeat>
                    </td>
                </tr>
            </table>
        </section>
      </span>


      <span id="S2">
        <section headerLabel="2. Demographic Information">
            <table class="baseline-aligned">
                <tr>
                    <td class="label">Name:</td>
                    <td>
                        <lookup class="value" expression="patient.personName"/>
                    </td>
                </tr>
                <tr>
                    <td class="label">Phone Number:</td>
                    <td>
                        <lookup class="value" expression="patient.phoneNumber"/>
                    </td>
                </tr>
                <tr>
                    <td class="label">Old Identification Number:</td>
                    <td>
                        <lookup class="value"
                                complexExpression="#foreach( $patId in $patientIdentifiers.get('Old Identification Number') ) $patId #end "/>
                    </td>
                </tr>
                <tr>
                    <td class="label">OpenMRS Identification Number:</td>
                    <td>
                        <lookup class="value"
                                complexExpression="#foreach( $patId in $patientIdentifiers.get('OpenMRS Identification Number') ) $patId #end "/>
                    </td>
                </tr>
                <tr>
                    <td class="label">Gender:</td>
                    <td>
                        <lookup class="value" expression="patient.gender"/>
                    </td>
                </tr>
                <tr>
                    <td class="label">Birthdate:</td>
                    <td>
                        <lookup class="value" complexExpression="#if( \$patient.birthdateEstimated ) ~#end"/>
                        <lookup class="value" expression="patient.birthdate"/>
                        (Age:
                        <lookup class="value" expression="patient.age"/>
                        )
                    </td>
                </tr>
                <tr>
                    <td class="label">Birthplace:</td>
                    <td>
                        <lookup class="value" expression="personAttributes.get('Birthplace')"/>
                    </td>
                </tr>
                <tr>
                    <td class="label">Citizenship:</td>
                    <td>
                        <lookup class="value" expression="personAttributes.get('Citizenship')"/>
                    </td>
                </tr>
                <tr>
                    <td class="label">Civil Status:</td>
                    <td>
                        <lookup class="value" expression="personAttributes.get('Civil Status').name.name"/>
                    </td>
                </tr>
                <tr>
                    <td class="label">Health Center:</td>
                    <td>
                        <lookup class="value" expression="personAttributes.get('Health Center')"/>
                    </td>
                </tr>
                <tr>
                    <td class="label">Health District:</td>
                    <td>
                        <lookup class="value" expression="personAttributes.get('Health District')"/>
                    </td>
                </tr>
                <tr>
                    <td class="label">Mother's Name:</td>
                    <td>
                        <lookup class="value" expression="personAttributes.get('Mothers Name')"/>
                    </td>
                </tr>
                <tr>
                    <td class="label">Race:</td>
                    <td>
                        <lookup class="value" expression="personAttributes.get('Race')"/>
                    </td>
                </tr>
            </table>
        </section>
      </span>

      <span id="S3">
        <section headerLabel="3. Method of HIV Exposure">
            <table class="baseline-aligned">
                <tr>
                    <td class="label">Method of HIV Exposure:</td>
                    <td>
                        <obs conceptId="162076" id="methodOfHIVExposure"/>
                    </td>
                </tr>
                <tr id="methodOfHIVExposureOtherRow">
                    <td class="label">Other:</td>
                    <td>
                        <obs conceptId="161011" id="methodOfHIVExposureOther" field="methodOfHIVExposureOther" style="textarea" rows="3" cols="40"/>
                    </td>
                </tr>
            </table>
        </section>
      </span>


      <!-- Note: This section shows up only for Females -->
      <span id="S4">
        <section headerLabel="4. Pregnancy">
            <table class="baseline-aligned">
                <includeIf velocityTest="$patient.gender == 'F' ">
                    <tr>
                        <td class="label">Is the patient pregnant?</td>
                        <td>
                            <obs conceptId="5272" style="radio"/>
                        </td>
                    </tr>

                    <tr>
                        <td class="label">Last menstrual period:</td>
                        <td>
                            <obs conceptId="1427"/>
                        </td>
                    </tr>
                </includeIf>
            </table>
        </section>
      </span>


    <span id="S5">
      <section headerLabel="5. Presenting Complaint">
          <table class="checkboxGroup" style="width:auto;">
            <tr id="checkboxAll">
                <td class="nested-td">
                    <obs field="R_noComplaints" id="noComplaints" conceptId="1069" answerConceptId="664" answerLabel="No complaints" style="checkbox"/>
                </td>
            </tr>
            <tr id="checkboxCheckbox">
                <obsgroup groupingConceptId="143264">
                    <td class="enableDisable">
                        <div id="trigger">
                            <obs field="CP_cough" conceptId="1071" answerConceptId="143264" answerLabel="Cough" style="checkbox"/>
                        </div>
                        <div id="disabled" class="secondary">
                            <span class="duration">
                                Duration: <obs field="CP_coughDuration" conceptId="1731"/><obs field="CP_coughDuration" conceptId="1732" answerConceptIds="1822,1072,1073,1074,1734" />
                            </span>

                            <div class="enableDisable">
                                <div id="trigger">
                                    <obs field="CP_productiveCough" conceptId="1071" answerConceptId="5957" answerLabel="Productive Cough" style="checkbox"/>
                                </div>
                                <div id="disabled" class="secondary">
                                    <obs field="CP_productiveCoughIsWhite" conceptId="5958" labelText="Quality: " answerConceptId="1075" answerLabel="White"/>
                                    <obs field="CP_productiveCoughIsPurulent" conceptId="5958" answerConceptId="1076" answerLabel="Purulent"/>
                                    <obs field="CP_productiveCoughIsBlood" conceptId="5958" answerConceptId="1077" answerLabel="Blood"/>
                                </div>
                            </div>
                        </div>
                    </td>
                </obsgroup>
                <obsgroup groupingConceptId="141600">
                    <td class="enableDisable">
                        <div id="trigger">
                            <obs field="CP_short" conceptId="1071" answerConceptId="141600" answerLabel="Shortness of breath" style="checkbox"/>
                        </div>
                        <div id="disabled">
                            <div class="secondary">
                                <obs field="CP_shortRest" conceptId="1071" answerConceptId="5961" answerLabel="At rest" style="checkbox"/>
                                <obs field="CP_shortExert" conceptId="1071" answerConceptId="5973" answerLabel="On exertion" style="checkbox"/>
                            </div>
                            <div class="secondary">
                                <span class="duration">
                                    Duration: <obs field="CP_shortDuration" conceptId="1731"/><obs field="CP_shortDurationUnits" conceptId="5962" answerConceptIds="1822,1072,1073,1074,1734" />
                                </span>
                            </div>
                        </div>
                    </td>
                </obsgroup>
            </tr>
            <tr class="checkboxGroup">
                <td class="nested-td">

                    <div class="enableDisable">
                        <div id="trigger">
                            <span><obs id="GENERAL_weightLoss" field="GENERAL_weightLoss" conceptId="1628" answerConceptId="832" answerLabel="Weight loss" style="checkbox"/></span>
                        </div>
                        <div id="disabled" class="secondary">
                            Details: <obs field="WL_1" id="WL_1" conceptId="161011" /><br/>
                            <obs field="WL_2" conceptId="1858" answerConceptIds="5332,5333" answerLabels="Weight loss 10% or more,Weight loss less than 10%" style="radio" />
                        </div>
                    </div>
                </td>
            </tr>
            <tr class="checkboxGroup">                
                <td class="nested-td">
                    <obs field="CNS_h" conceptId="1082" answerConceptId="139084" answerLabel="Headache" style="checkbox"/>
                </td>
            </tr>
            <tr class="checkboxGroup">                
                <td class="nested-td">
                    <obs conceptId="1082" answerConceptId="118789" answerLabel="Pain when swallowing" style="checkbox"/>
                </td>
            </tr>
            <tr class="checkboxGroup">                
                <td class="nested-td">
                    <obs field="R_fever" id="fever" conceptId="1069" answerConceptId="140238" answerLabel="Fever" style="checkbox"/>
                </td>
            </tr>   
            <tr id="checkboxCheckbox">
                <obsgroup groupingConceptId="5978">
                    <td class="enableDisable">
                        <div id="trigger">
                            <obs field="GI_nausea" conceptId="1078" answerConceptId="5978" answerLabel="Nausea" style="checkbox"/>
                        </div>
                        <div id="disabled" class="secondary">
                            <span class="duration">
                                Duration: <obs field="GI_nauseaDuration" conceptId="1731"/><obs field="GI_nauseaDurationUnits" conceptId="5979"/>
                            </span>
                        </div>
                    </td>
                </obsgroup>
                <obsgroup groupingConceptId="122983">
                    <td class="enableDisable">
                        <div id="trigger">
                            <obs field="GI_vomiting" conceptId="1078" answerConceptId="122983" answerLabel="Vomiting" style="checkbox"/>
                        </div>
                        <div id="disabled" class="secondary">
                            <span class="duration">
                                Duration: <obs field="GI_vomitingDuration" conceptId="1731"/><obs field="GI_vomitingDurationUnits" conceptId="5981" />
                            </span>
                        </div>
                    </td>
                </obsgroup>
            </tr>
            <tr id="checkboxCheckbox">
                <obsgroup groupingConceptId="142412">
                    <td class="enableDisable">
                        <div id="trigger">
                            <obs field="GI_diarrhea" conceptId="1078" answerConceptId="142412" answerLabel="Diarrhea" style="checkbox"/>
                        </div>
                        <div id="disabled" class="secondary">
                            <span class="duration">
                                Duration: <obs field="GI_diarrheaDuration" conceptId="1731"/><obs field="GI_diarrheaDurationUnits" conceptId="5984" answerConceptIds="1072,1073,1074" answerLabels="Days,Weeks,Months" defaultValue="1072"/>
                            </span>
                        </div>
                    </td>
                </obsgroup>
                <obsgroup groupingConceptId="996">
                    <td class="enableDisable">
                        <div id="trigger">
                            <obs field="GI_constipation" conceptId="1078" answerConceptId="996" answerLabel="Constipation" style="checkbox"/>
                        </div>
                        <div id="disabled" class="secondary">
                            <span class="duration">
                                Duration: <obs field="GI_constipationDuration" conceptId="1731"/><obs field="GI_constipationDurationUnits" conceptId="1732" answerConceptIds="1072,1073,1074,1734" />
                            </span>
                        </div>
                    </td>
                </obsgroup>
            </tr>
            <tr id="checkboxCheckbox">
                <td class="nested-td">
                    <obs field="R_nightSweats" id="nightSweats" conceptId="1069" answerConceptId="133027" answerLabel="Night sweats" style="checkbox"/>
                </td>
            </tr>   
            <tr id="checkboxCheckbox">
                <td class="nested-td">
                    <obs field="CNS_pares" conceptId="1082" answerConceptId="6004" answerLabel="Paresthesia" style="checkbox"/>
                </td>
            </tr>
            <tr>
                <td>
                    Comments:
                    <div class="secondary"><obs conceptId="161011" id='PC_1' field='PC_1' style="textarea" rows="8" cols="75"/></div>
                </td>
            </tr>
          </table>
      </section>
    </span>

    <span id="S6">
      <section headerLabel="6. HIV Lab Results">
          <table class="baseline-aligned">
              <tr>
                  <td class="label">Last CD4 count:</td>
                  <td>
                      <obs conceptId="5497" dateLabel="Last CD4 count date:"/>
                  </td>
                  <td>
                    
                  </td>
              </tr>
              <tr>
                  <td class="label">CD4 prior to starting ARV:</td>
                  <td>
                      <obs conceptId="5497" name='cd4_prioir_to_starting_arv'/>
                  </td>
              </tr>
              <tr>
                  <td class="label"> Last Viral Load:</td>
                  <td>
                      <obs conceptId="856" dateLabel="Viral Load Test Date:"/>
                  </td>
              </tr>


          </table>
      </section>
    </span>


    <span id="S7">
      <section headerLabel="7. Physical Exam">
      <h4>Vitals</h4>

      <table style="width:100%;">
          <tr>
              <td style="width:50%;">
                  <table class="two-wide">
                      <tr>
                          <td class="nested-label">BP</td>
                          <td class="nested-td">
                              <obs field="BP" conceptId="5085"/>
                              /
                              <obs field="bp1-2" conceptId="5086"/>
                          </td>
                      </tr>
                      <tr>
                          <td class="nested-label">Pulse</td>
                          <td class="nested-td">
                              <obs field="BP2" conceptId="5087"/>
                              rate/min
                          </td>
                      </tr>
                      <tr>
                          <td class="nested-label">Resp Rate</td>
                          <td class="nested-td">
                              <obs field="BP3" conceptId="5242"/>
                          </td>
                      </tr>
                      <tr>
                          <td class="nested-label">Temp</td>
                          <td class="nested-td">
                              <obs field="BP4" conceptId="5088"/>
                              [C&#176;]
                          </td>
                      </tr>
                      <tr>
                          <td class="nested-label">SpO2</td>
                          <td class="nested-td">
                              <obs field="BP7" conceptId="5092"/>
                              %
                          </td>
                      </tr>
                      <tr>
                          <td class="nested-label">Wt</td>
                          <td class="nested-td">
                              <obs field="BP8" conceptId="5089"/>
                              kg
                          </td>
                      </tr>
                      <tr>
                          <td class="nested-label">Height</td>
                          <td class="nested-td">
                              <obs field="BP9" conceptId="5090"/>
                              cm
                          </td>
                      </tr>
                  </table>
              </td>
              <td style="width:50%;">
                  <!-- Nothing here for now -->
              </td>
          </tr>
      </table>


      <hr/>
      <table class="two-wide" style="width:100%;">
      <tr>
          <td style="width:50%;"><h4>General Exam</h4>
              <table>
                  <tr>
                      <td class="nested-td">
                          <obs field="SKIN_TW" answerConceptId="5201" conceptId="1119" style="checkbox"
                               answerLabel="Temporal wasting"/>
                          <br/><br/>
                      </td>
                      <td class="nested-td">
                          <obs field="SH_pallor" answerConceptId="5245" conceptId="1119" style="checkbox"
                               answerLabel="Pallor"/>
                      </td>
                      <td class="nested-td">
                          <obs field="SH_jaundice" answerConceptId="136443" conceptId="1119" style="checkbox"
                               answerLabel="Jaundice"/>
                      </td>
                  </tr>
              </table>

              Comments:
              <div class="secondary">
                  <obs field="GEX_COMMENTS" conceptId="161011" id='GEX_COMMENTS' style="textarea" rows="5"
                       cols="50" />
              </div>
          </td>
          <td class="checkboxGroup" style="width:50%;">
              <h4>Skin Exam</h4>
              <span id="checkboxAll"><obs field="SKIN_normal" answerConceptId="1115" conceptId="1120" style="checkbox"
                                          answerLabel="Normal"></obs></span>
            <span id="checkboxCheckbox" class="enableDisable">
              <span id="trigger"><obs field="SKIN_abnormal" answerConceptId="1116" conceptId="1120" style="checkbox"
                                      answerLabel="Abnormal"></obs></span>
              <span id="disabled">
                <span id="checkboxCheckbox" class="enableDisable">
                  <span id="trigger"><obs field="SKIN_rash" answerConceptId="512" conceptId="1120" style="checkbox"
                                          answerLabel="Rash"></obs>
                  </span>
                  <span id="disabled">
                    <obs field="SKIN_rashType" answerConceptIds="522,520,521,128047,123198,118731,123468,160639"
                         conceptId="1120" style="checkbox"
                         answerLabels="Maculopapular,Macule(s),Papule(s),Pustules,Vesicle,Eczema,Urticaria,Bulla(e)"></obs>
                  </span>
                </span>
                <!--<obs field="SKIN_kap" answerConceptId="507" conceptId="1120" style="checkbox"
                     answerLabel="Kaposi sarcoma"></obs>-->
    <obs field="SKIN_ulcer" answerConceptId="112934" conceptId="1120" style="checkbox" answerLabel="Ulcer"></obs>
              </span>
            </span>
              <br/><br/>Comments:
              <div class="secondary">
                  <obs field="SKIN_comments" id="SKIN_comments" conceptId="161011" style="textarea" rows="5"
                       cols="50" />
              </div>
          </td>
      </tr>
      <tr>
          <td style="width:50%;">
              <table>
                  <tr class="checkboxGroup">
                      <td style="border-style:none;">
                          <h4>Lymph Nodes Exam</h4>
                          <span id="checkboxAll"><obs field="LN_normal" answerConceptId="1066" conceptId="160607"
                                                      style="checkbox" answerLabel="Not Palpable"></obs></span>
                          <span id="checkboxAll"> <obs field="LNUNKW" answerConceptId="1067" conceptId="160607"
                                                       style="checkbox" answerLabel="Unknown"></obs></span>
            <span id="checkboxCheckbox" class="enableDisable">
              <span id="trigger"><obs field="LN_abnormal" answerConceptId="1065" conceptId="160607" style="checkbox"
                                      answerLabel="Palpable"></obs></span><br/>
              <span id="disabled">
                <obs field="LN_sub" answerConceptId="504" conceptId="1121" style="checkbox"
                     answerLabel="submandibular"></obs>
                <obs field="LN_cerv" answerConceptId="643" conceptId="1121" style="checkbox" answerLabel="cervical"></obs>
                <obs field="LN_ingui" answerConceptId="506" conceptId="1121" style="checkbox" answerLabel="inguinal"></obs>
                <obs field="LN_supra" answerConceptId="505" conceptId="1121" style="checkbox"
                     answerLabel="supraclavicular"></obs>
                <obs field="LN_axil" answerConceptId="5112" conceptId="1121" style="checkbox" answerLabel="axillary"></obs>
                <obs field="LN_epit" answerConceptId="160679" conceptId="1121" style="checkbox"
                     answerLabel="epitrochlear"></obs>
    <br/>
    Characteristic: <obs field="LYMPH_1" conceptId="160398" answerConceptIds="160405,160399,160400,160401"
                         answerLabels="Soft,Firm,Rubbery,Hard" style="radio"/>
    <br/>
    Mobility: <obs field="LYMPH_5" conceptId="160378" answerConceptIds="160376,160377" answerLabels="Fixed,Mobile"
                   style="radio"/>
              </span>
            </span><br/>
                      </td>
                  </tr>

              </table>
              Comments:
              <div class="secondary">
                  <obs field="LN_comments" id="LN_comments" conceptId="161011" style="textarea" rows="5"
                       cols="50" />
              </div>
          </td>
          <td class="checkboxGroup" style="width:50%;">
              <h4>HEENT Exam</h4>
              <span id="checkboxAll"><obs field="PEHEENT_normal" answerConceptId="1115" conceptId="1122" style="checkbox"
                                          answerLabel="Normal"></obs></span>
            <span id="checkboxCheckbox" class="enableDisable">
              <span id="trigger"><obs field="PEHEENT_abnormal" answerConceptId="1116" conceptId="1122" style="checkbox"
                                      answerLabel="Abnormal"></obs></span>
              <span id="disabled">
                <br/>
                <b>Eyes:</b>
                <obs field="PEHEENT_sclera" answerConceptId="5192" conceptId="1122" style="checkbox"
                     answerLabel="Sclera icteric"></obs>
                <obs field="PEHEENT_conjunct" answerConceptId="516" conceptId="1122" style="checkbox"
                     answerLabel="Conjunctiva pale"></obs>
                <obs field="PEHEENT_fundal" answerConceptId="518" conceptId="1122" style="checkbox"
                     answerLabel="Fundal abnormality"></obs>
                <br/>
                <b>Ears:</b>
                <obs field="PEHEENT_cerumen" answerConceptId="530" conceptId="1122" style="checkbox"
                     answerLabel="Cerumen impaction"></obs>
                <obs field="PEHEENT_tm" answerConceptId="948" conceptId="1122" style="checkbox"
                     answerLabel="TM injected"></obs>
                <br/>
                <b>Neck:</b>
                <obs field="PEHEENT_trachea" answerConceptId="513" conceptId="1122" style="checkbox"
                     answerLabel="Trachea deviated"></obs>
                <obs field="PEHEENT_nuchal" answerConceptId="5170" conceptId="1122" style="checkbox"
                     answerLabel="Nuchal rigidity"></obs>
                <br/>
                <b>Oropharynx:</b>
                <obs field="PEHEENT_thrush" answerConceptId="5334" conceptId="1122" style="checkbox"
                     answerLabel="Thrush"></obs>
                <obs field="PEHEENT_kaposi_sarcoma" answerConceptId="644" conceptId="1122" style="checkbox"
                     answerLabel="Kaposi Sarcoma"></obs>
                <obs field="PEHEENT_poor" answerConceptId="147999" conceptId="1122" style="checkbox"
                     answerLabel="Poor dentition"></obs>
                                                    <obs field="PEHEENT_ulcers" answerConceptId="160614" conceptId="1122"
                                                         style="checkbox" answerLabel="Ulcers"></obs>
    <br/><b>Tonsils: </b>
                                                    <obs field="PEHEENT_enlarged" answerConceptId="536" conceptId="1122"
                                                         style="checkbox" answerLabel="Enlarged"/>
                                                     <obs field="PEHEENT_erythe" answerConceptId="535" conceptId="1122"
                                                          style="checkbox" answerLabel="Erythematous"/>
                                                     <obs field="PEHEENT_exudate" answerConceptId="537" conceptId="1122"
                                                          style="checkbox" answerLabel="Exudate"/>



                <br/>
              </span>
            </span><br/>
              Comments:
              <div class="secondary">
                  <obs field="PEHEENT_comments" id="PEHEENT_comments"  conceptId="161011"  style="textarea" rows="5"
                       cols="50" />
              </div>
          </td>
      </tr>
      <tr>
          <td class="checkboxGroup" style="width:50%;">
              <h4>Chest Exam</h4>
              <span id="checkboxAll"><obs field="CHEST_normal" answerConceptId="1115" conceptId="1123" style="checkbox"
                                          answerLabel="Normal"></obs></span>
            <span id="checkboxCheckbox" class="enableDisable">
              <span id="trigger"><obs field="CHEST_abnormal" answerConceptId="1116" conceptId="1123" style="checkbox"
                                      answerLabel="Abnormal"></obs></span>
              <span id="disabled">
                <br/>
                <b>Percussion:</b>
                <obs field="CHEST_dull" answerConceptId="5138" conceptId="1123" style="checkbox"
                     answerLabel="Dullness"></obs>
                <br/>
                                                    <b>Accessory Muscle Use:</b>
                      <obs field="CHEST_amu" answerConceptId="159441" conceptId="1123" style="checkbox"
                           answerLabel="Accessory Muscle Use"></obs>
                <br/>
                <b>Auscultation:</b>
                <obs field="CHEST_diminished" answerConceptId="5115" conceptId="1123" style="checkbox"
                     answerLabel="Breath sounds diminished"></obs>
                <obs field="CHEST_bronchial" answerConceptId="5116" conceptId="1123" style="checkbox"
                     answerLabel="Bronchial breath sounds"></obs>
                <obs field="CHEST_ronchi" answerConceptId="5181" conceptId="1123" style="checkbox"
                     answerLabel="Rhonchi"></obs>
    <br/>
                <obs field="CHEST_wheezes" answerConceptId="5209" conceptId="1123" style="checkbox"
                     answerLabel="Wheezes"></obs>
                <obs field="CHEST_crepitations" answerConceptId="5127" conceptId="1123" style="checkbox"
                     answerLabel="Crepitations"></obs>
    <br/><b>Lung Finding:</b>
    <obs field="CHEST_LUNGfinding" conceptId="159370" answerConceptIds="5120,5132,639,5119,5134,5141,5139,160406"
         answerLabels="Right middle lobe,left upper lobe,Right lower lobe,Right upper lobe,Left lower lobe,Right,Left,Bilateral"
         style="dropdown"/>
                <br/>
              </span>
            </span>
              <br/>
              Comments:
              <div class="secondary">
                  <obs field="CHEST_comments" id="CHEST_comments" conceptId="161011" style="textarea" rows="5"
                       cols="50" />
              </div>
          </td>
          <td class="checkboxGroup" style="width:50%;">
              <h4>Heart Exam</h4>
              <span id="checkboxAll"><obs field="HEART_normal" answerConceptId="1115" conceptId="1124" style="checkbox"
                                          answerLabel="Normal"></obs></span>
            <span id="checkboxCheckbox" class="enableDisable">
              <span id="trigger"><obs field="HEART_abnormal" answerConceptId="1116" conceptId="1124" style="checkbox"
                                      answerLabel="Abnormal"></obs></span>
              <span id="disabled">
                <br/>
                <span id="checkboxCheckbox" class="enableDisable">
                  <span id="trigger"><obs field="HEART_evidence" answerConceptId="5158" conceptId="1124" style="checkbox"
                                          answerLabel="Evidence for enlargement:"></obs></span>
                  <span id="disabled">
                    <obs field="HEART_lv" answerConceptId="5156" conceptId="1124" style="checkbox"
                         answerLabel="LV lift"></obs>
                    <obs field="HEART_rv" answerConceptId="5157" conceptId="1124" style="checkbox"
                         answerLabel="RV lift"></obs>
                    <br/>
                  </span>
                </span>
                <span id="checkboxCheckbox" class="enableDisable">
                  <span id="trigger"><obs field="HEART_sounds" answerConceptId="1117" conceptId="1124" style="checkbox"
                                          answerLabel="Abnormal Sounds:"></obs></span>
                  <span id="disabled">
                    <obs field="HEART_s3" answerConceptId="550" conceptId="1124" style="checkbox" answerLabel="S3"></obs>
                    <obs field="HEART_s4" answerConceptId="551" conceptId="1124" style="checkbox" answerLabel="S4"></obs>
                    <obs field="HEART_friction" answerConceptId="130560" conceptId="1124" style="checkbox"
                         answerLabel="Pericardial friction rub"></obs>
                    <br/>
                  </span>
                </span>
                <span id="checkboxCheckbox" class="enableDisable">
                  <span id="trigger"><obs field="HEART_murmurs" answerConceptId="139063" conceptId="1124" style="checkbox"
                                          answerLabel="Murmurs:"></obs></span>
                  <span id="disabled">
                    <obs field="HEART_systolic" answerConceptId="5166" conceptId="1124" style="checkbox"
                         answerLabel="Systolic Ejection Murmur"></obs>
                    <obs field="HEART_holosystolic" answerConceptId="5162" conceptId="1124" style="checkbox"
                         answerLabel="Holosystolic Murmur"></obs>
                    <obs field="HEART_diastolicDecrescendo" answerConceptId="5160" conceptId="1124" style="checkbox"
                         answerLabel="Diastolic Decrescendo"></obs>
                    <obs field="HEART_rumble" answerConceptId="5164" conceptId="1124" style="checkbox"
                         answerLabel="Diastolic Rumble"></obs><br/>
                    <br/>
                  </span>
                </span>
              </span>
            </span>
              <br/>
              Comments:
              <div class="secondary">
                  <obs field="HEART_comments" id="HEART_comments"  conceptId="161011" style="textarea" rows="5"
                       cols="50" />
              </div>
          </td>

      </tr>
      <tr>
          <td class="checkboxGroup" style="width:50%;">
              <h4>Abdomen Exam</h4>
              <span id="checkboxAll"><obs field="ABDOMEN_normal" answerConceptId="1115" conceptId="1125" style="checkbox"
                                          answerLabel="Normal"></obs></span>
            <span id="checkboxCheckbox" class="enableDisable">
              <span id="trigger"><obs field="ABDOMEN_abnormal" answerConceptId="1116" conceptId="1125" style="checkbox"
                                      answerLabel="Abnormal"></obs></span>
              <span id="disabled">
                <br/>
    Tender to palpation: <obs field="ABDOENTENDER" conceptId="1125" style="dropdown"
                              answerConceptIds="160380,5104,5107,160381,5099,575,140070,124998"
                              answerLabels="Left upper quadrant,Left lower quadrant,Right upper quadrant,Right lower quadrant,Epigastric,Suprapubic,Flank pain,Periumbilical"/><br/>

                <obs field="ABDOMEN_ascites" answerConceptId="148346" conceptId="1125" style="checkbox"
                     answerLabel="Ascites"></obs>
                <obs field="ABDOMEN_mass" answerConceptId="5103" conceptId="1125" style="checkbox" answerLabel="Mass"></obs>
                <span id="checkboxCheckbox" class="enableDisable">
                  <span id="trigger"><obs field="ABDOMEN_hepatome" answerConceptId="5008" conceptId="1125" style="checkbox"
                                          answerLabel="Hepatomegaly"></obs></span>
                  <span id="disabled">
                    <obs field="ABDOMEN_cmbelow" conceptId="159447"></obs>(cm below costal margin)
                    <br/>
                  </span>
                </span>
                <span id="checkboxCheckbox" class="enableDisable">
                  <span id="trigger"><obs field="ABDOMEN_splenomegaly" answerConceptId="5009" conceptId="1125"
                                          style="checkbox" answerLabel="Splenomegaly"></obs></span>
                  <span id="disabled">
                    <obs field="ABDOMEN_cmbelowsplen" conceptId="159448"></obs>(cm below costal margin)
                    <br/>
                  </span>
                </span>

              </span>
            </span>
              <br/>Comments:
              <div field="ABDOMEN_comments" class="secondary">
                  <obs field="abcomments" id="abcomments"  conceptId="161011" style="textarea" rows="5"
                       cols="50" />
              </div>
          </td>
          <td class="checkboxGroup" style="width:50%;">
              <h4>Urogenital Exam</h4>
            <span id="checkboxRadio"><obs field="UG2_normal" answerConceptId="1115" conceptId="1126" style="checkbox"
                                          answerLabel="Normal"></obs>
              <obs field="UG2_abnormal" answerConceptId="1116" conceptId="1126" style="checkbox"
                   answerLabel="Abnormal"></obs>
              <obs field="UG2_notDone" answerConceptId="1118" conceptId="1126" style="checkbox"
                   answerLabel="Not Done"></obs>
            </span>
              <br/><br/>Comments:
              <div class="secondary">
                  <obs field="UG2_comments" id="UG2_comments"  conceptId="161011" style="textarea" rows="5"
                       cols="50" />
              </div>
          </td>
      </tr>
      <tr>
          <td class="checkboxGroup" style="width:50%;">
              <h4>Extremities Exam</h4>
              <span id="checkboxAll"><obs field="EXT_normal" answerConceptId="1115" conceptId="1127" style="checkbox"
                                          answerLabel="Normal"></obs></span>
            <span id="checkboxCheckbox" class="enableDisable">
              <span id="trigger"><obs field="EXT_abnormal" answerConceptId="1116" conceptId="1127" style="checkbox"
                                      answerLabel="Abnormal"></obs></span>
              <span id="disabled">
                <obs field="EXT_edema" answerConceptId="590" conceptId="1127" style="checkbox" answerLabel="Edema"></obs>
                <obs field="EXT_leg" answerConceptId="111725" conceptId="1127" style="checkbox"
                     answerLabel="Leg Ulcers"></obs>
                <obs field="EXT_cell" answerConceptId="134" conceptId="1127" style="checkbox"
                     answerLabel="Cellulitis"></obs>
                <obs field="EXT_kaposi" answerConceptId="507" conceptId="1127" style="checkbox"
                     answerLabel="Kaposi sarcoma"></obs>
              </span>
            </span>
              <br/><br/>Comments:
              <div class="secondary">
                  <obs field="EXT_comments" id="EXT_comments" conceptId="161011" style="textarea" rows="5"
                       cols="50" />
              </div>
          </td>
          <td style="width:50%;" class="checkboxGroup">
              <h4>Musculoskeletal Exam</h4>
              <span id="checkboxAll"><obs conceptId="1128" answerConceptId="1115" style="checkbox" answerLabel="Normal"
                                          field="MS21"/></span>
            <span id="checkboxCheckbox" class="enableDisable"><span id="trigger"><obs conceptId="1128"
                                                                                      answerConceptId="1116"
                                                                                      style="checkbox"
                                                                                      answerLabel="Abnormal" field="MS22"/></span><span
                    id="disabled">
            <obs conceptId="1128" answerConceptId="5312" style="checkbox" answerLabel="Joint Swelling" field="MS23"/>
            <obs conceptId="1128" answerConceptId="5313" style="checkbox" answerLabel="Muscle Tenderness"
                 field="MS24"/></span></span>
              <br/><br/>Comments:
              <div class="secondary">
                  <obs field="MS2_comment" id="MS2_comment"  conceptId="161011" style="textarea" rows="5"
                       cols="50" />
              </div>
          </td>
      </tr>
      <tr>
          <td class="checkboxGroup" style="width:50%;">
              <h4>Neurologic Exam</h4>
              <span id="checkboxAll"><obs field="NL2_normal" answerConceptId="1115" conceptId="1129" style="checkbox"
                                          answerLabel="Normal"></obs></span>
            <span id="checkboxCheckbox" class="enableDisable">
              <span id="trigger"><obs field="NL2_abnormal" answerConceptId="1116" conceptId="1129" style="checkbox"
                                      answerLabel="Abnormal"></obs></span>
              <span id="disabled">
                <obs field="NL2_cranial" answerConceptId="599" conceptId="1129" style="checkbox"
                     answerLabel="Cranial nerve abnormality"></obs>
                <obs field="NL2_lower" answerConceptId="5135" conceptId="1129" style="checkbox"
                     answerLabel="Decreased sensation in extremities"></obs>
                <obs field="NL2_gait" answerConceptId="5108" conceptId="1129" style="checkbox"
                     answerLabel="Abnormal gait"></obs>
                <obs field="NL2_focal" answerConceptId="6005" conceptId="1129" style="checkbox"
                     answerLabel="Focal weakness"></obs>
              </span>
            </span><br/><br/>Comments:
              <div class="secondary">
                  <obs field="NL2_comments" id="NL2_comments" conceptId="161011" style="textarea" rows="5"
                       cols="50" />
              </div>
          </td>
          <td class="checkboxGroup" style="width:50%;">
              <h4>Psychiatric Exam</h4>
              <span id="checkboxAll"><obs field="PSYCH_normal" answerConceptId="1115" conceptId="1130" style="checkbox"
                                          answerLabel="Normal"></obs></span>
            <span id="checkboxCheckbox" class="enableDisable">
              <span id="trigger"><obs field="PSYCH_abnormal" answerConceptId="1116" conceptId="1130" style="checkbox"
                                      answerLabel="Abnormal"></obs></span>


              <span id="disabled">
                <obs field="PSYCH_depressed" answerConceptId="119537" conceptId="1130" style="checkbox"
                     answerLabel="Depressed"></obs>
                <obs field="PSYCH_confused" answerConceptId="120345" conceptId="1130" style="checkbox"
                     answerLabel="Confused"></obs>
    <obs field="PSYCH_psychosis" answerConceptId="113517" conceptId="1130" style="checkbox" answerLabel="Psychosis"></obs>
    <obs field="PSYCH_anxiety" answerConceptId="121543" conceptId="1130" style="checkbox" answerLabel="Anxiety"></obs>
    <obs field="PSYCH_manic" answerConceptId="115926" conceptId="1130" style="checkbox" answerLabel="Manic"></obs>
    <obs field="PSYCH_suicidal" answerConceptId="158978" conceptId="1130" style="checkbox" answerLabel="Suicidal"></obs>
              </span>
            </span>
              <br/><br/>Comments:
              <div class="secondary">
                  <obs field="PSYCH_comments" id="PSYCH_comments"  conceptId="161011" style="textarea" rows="5"
                       cols="50" />
              </div>
          </td>
      </tr>
      </table>
	  
      </section>
    </span>

	
	

<!-- ARV SECTIONS BEGIN FROM HERE -->
<section>
    <span class="majorSection"><center><h3>ARV Section</h3></center></span>
</section>


    <span id="S8">
      <section headerLabel="8. ARV Side-Effects">

          <table class="baseline-aligned">
              <tr>
                  <td class="enableDisable">
                    <div id='trigger' class='arv_side_effect_trigger'>Is ARV Side-Effect Reported?<obs conceptId='162083' style='checkbox'/></div>
                    <div id="disabled" class="secondary arv_side_effect_required">
                        <table>
                          <tr>
                              <td>
                                  <label class="info-message">Please select side effects</label>
                              </td>
                          </tr>
                          <tr >
                              <td class="spaced-out-td">
                                  <obs conceptId="159935" answerConceptId="151" answerLabel="Abdominal Pain" style="checkbox"/>
                              </td>
                              <td class="spaced-out-td">
                                  <obs conceptId="159935" answerConceptId="121629" answerLabel="Anaemia" style="checkbox"/>
                              </td>
                              <td class="spaced-out-td">
                                  <obs conceptId="159935" answerConceptId="121543" answerLabel="Anxiety" style="checkbox"/>
                              </td>
                              <td class="spaced-out-td">
                                  <obs conceptId="159935" answerConceptId="6004" answerLabel="Burning/Numbness Tingling" style="checkbox"/>
                              </td>
                              <td class="spaced-out-td">
                                  <obs conceptId="159935" answerConceptId="142412" answerLabel="Diarrhoea" style="checkbox"/>
                              </td>
                          </tr>

                          <tr>
                              <td class="spaced-out-td">
                                  <obs conceptId="159935" answerConceptId="156046" answerLabel="Dizzy" style="checkbox"/>
                              </td>
                              <td class="spaced-out-td">
                                  <obs conceptId="159935" answerConceptId="135764" answerLabel="Fat Changes" style="checkbox"/>
                              </td>
                              <td class="spaced-out-td">
                                  <obs conceptId="159935" answerConceptId="140501" answerLabel="Fatigue" style="checkbox"/>
                              </td>
                              <td class="spaced-out-td">
                                  <obs conceptId="159935" answerConceptId="139084" answerLabel="Headache" style="checkbox"/>
                              </td>
                              <td class="spaced-out-td">
                                  <obs conceptId="159935" answerConceptId="136443" answerLabel="Jaundice" style="checkbox"/>
                              </td>
                          </tr>

                          <tr>
                              <td class="spaced-out-td">
                                  <obs conceptId="159935" answerConceptId="5978" answerLabel="Nausea" style="checkbox"/>
                              </td>
                              <td class="spaced-out-td">
                                  <obs conceptId="159935" answerConceptId="159426" answerLabel="Nightmares" style="checkbox"/>
                              </td>
                              <td class="spaced-out-td">
                                  <obs conceptId="159935" answerConceptId="512" answerLabel="Rash" style="checkbox"/>
                              </td>
                              <td/>
                              <td/>
                          </tr>
                      </table>
                  </div>
              </td>
          </tr>
          </table>

      </section>

    </span>


    <span id="S9">
      <section headerLabel="9. ARV Adherence">

          <table class="baseline-aligned">

              <tr>
                  <td class="label">Any doses missed in the past WEEK:</td>
                  <td>
                      <obs conceptId="1164" style="radio"/>
                  </td>
              </tr>

              <tr>
                  <td class="label">Any doses missed in the past MONTH:</td>
                  <td>
                      <obs conceptId="1658" style="radio"/>
                  </td>
              </tr>

              <tr>
                  <td class="label">Reasons for poor adherence:</td>
                  <td>
                      <obs conceptId="160582" showCommentField="true"/>
                  </td>
              </tr>

          </table>

      </section>

    </span>


    <span id="S10">
      <section headerLabel="10. ARV Plan">

          <table class="baseline-aligned" >

              <tr>
                  <td class="label">Has the patient taken ARV before?</td>
                  <td>
                      <obs conceptId="5706" style="yes_no"/>
                  </td>
              </tr>
          </table>
          <table class="baseline-aligned">
              <tr>
                  <td class="enableDisable">
                    <div id='trigger' class='arv_eligibility_trigger'>Is this Patient Eligible For ARV?<obs conceptId='162084' style='checkbox'/></div>
                    <div id="disabled" class="secondary arv_eligibility_required">
                        <table>
                          <tr>
                              <td>
                                  <label class="info-message">Please select reasons for eligibility</label>
                              </td>
                          </tr>
                          <tr >
                             <td>
                                 <obs conceptId="162078" style='checkbox'/>
                                 <span>&lt;10yo</span>
                                 <br/>
                                 <obs conceptId="162079" style='checkbox'/>
                                 <span>Pregnant</span>
                                 <br/>
                                 <obs conceptId="162080" style='checkbox'/>
                                 <span>CD4 Count &lt;500</span>
                                 <br/>
                                 <obs conceptId="162081" style='checkbox'/>
                                 <span>WHO Stage 3 or 4</span>
                                 <br/>
                                 <obs conceptId="162082" style='checkbox'/>
                                 <span>Discordant Partner</span>
                               </td>
                          </tr>
                      </table>
                  </div>
              </td>
              </tr>
          </table>
          <table class="baseline-aligned">
              <tr>
                  <td class="label"> ARV Plan:</td>
                  <td>
                      <obs conceptId="1255" required="true" name='arv_plan' id='arv_plan'/>
                  </td>
              </tr>

              <tr>
                  <td class="label">Reason for ARV Stopping / Changing:</td>
                  <td>
                      <obs conceptId="1255" name='reason_for_arv_stopping_changing' field='reason_for_arv_stopping_changing' id='reason_for_arv_stopping_changing' 
                           answerConceptIds="102,1434,843,159598,5485,1754,819,5622,160016,983,1253,160018,1270,1258"
                           answerLabels="Toxicity/Side effects, Pregnancy, Treatment Failure,
                                       Poor adherence, Illness/Hospitalization, Drugs out of stock,
                                       Patient lacks finances, Other Patient Decision, Planned Rx Interruption,
                                       Weight Change, Completed PMTCT, Treatment Never Started, TB Treatment Started,
                                       Change Formulation"/>
                  </td>
              </tr>

              <tr>
                  <td class="label" width="20%">Current ARV:</td>
                  <td width="80%"><htmlformflowsheet formId="16"/>
                  </td>
              </tr>

          </table>

      </section>

    </span>



<section>
    <span class="majorSection"><center><h3>Prophylaxis Section</h3></center></span>
</section>


    <span id="S11">
      <section headerLabel="11. PCP Prophylaxis">

          <table class="baseline-aligned">

              <tr>
                  <td class="label">PCP/PJP Prophylaxis Plan: </td>
                  <td>
                      <obs conceptId="1261" id="pcp_prophylaxis_plan" required='true'/> Reason: <obs conceptId="162153" id="reasonProphylaxisChanged"/>
                  </td>
              </tr>

              <tr id="reasonProphylaxixStoppedDropdown_row">
                  <td class="label">
                      Reason PCP/PJP Prophylaxis Stopped:
                  </td>
                  <td>
                      <obs conceptId="1262" id="reasonProphylaxixStoppedDropdown"/>
                  </td>
              </tr>

              <tr id="reasonProphylaxisStoppedRow">
                  <td class="label">Reason:</td>
                  <td>
                      <obs conceptId="159395" id="reasonProphylaxisStopped" style="textarea" rows="3" cols="40"
                           disabled="true"/>
                  </td>
              </tr>

              <tr>
                  <td class="label">PCP/PJP Prophylaxis Started: </td>
                  <td>
                      <obs conceptId="1263" name="PCP_PJP_Prophylaxis_Started" answerConceptIds="1065,1066" style='radio'/>
                  </td>
              </tr>

              <tr>
                  <td class="label">PCP/PJP Prophylaxis Drug Regimen: </td>
                  <td>
                      <obs conceptId="1109" name="PCP_PJP_Prophylaxis_Drug_Regimen" />
                  </td>
              </tr>

              <tr>
                  <td class="label">During the last WEEK how many of his/her PCP pills did the patient take? </td>
                  <td>
                      <obs conceptId="6065" style="radio"/>
                  </td>
              </tr>


              <tr>
                  <td class="label">During the last MONTH how many of his/her PCP pills did the patient take? </td>
                  <td>
                      <obs conceptId="1680" style="radio"/>
                  </td>
              </tr>




          </table>

      </section>
    </span>


    <span id="S12">
      <section headerLabel="12. Cryptococcal Prophylaxis ">

          <table class="baseline-aligned">

              <tr>
                  <td class="label"> Cryptococcal Meningitis Prophylaxis: </td>
                  <td>
                      <obs conceptId="1683" showCommentField="true" />
                  </td>
              </tr>

              <tr>
                  <td class="label"> Cryptococcal Meningitis Prophylaxis Adherence in past WEEK: </td>
                  <td>
                      <obs conceptId="1247" style="radio"/>
                  </td>
              </tr>

              <tr>
                  <td class="label"> Cryptococcal Meningitis Prophylaxis Adherence in past MONTH: </td>
                  <td>
                      <obs conceptId="1682" style="radio"/>
                  </td>
              </tr>

          </table>

      </section>
    </span>


    <span id="S13">
      <section headerLabel="13. Tuberculosis ">

          <table class="baseline-aligned">

              <tr>
                  <td class="label">TB Status:</td>
                  <td>
                      <obs conceptId="1659" style="dropdown" required='true' field="tb_status" id="tb_status"/>
                  </td>
              </tr>

              <tr>
                  <td class="label">Treatment Status:</td>
                  <td>
                      <obs conceptId="1659"  field="tb_treatment_status" id="tb_treatment_status" name="tb_treatment_status"
                            answerConceptIds="1663,1662,1107,160332,160330"
                           answerLabels="Treatment completed,Treatment in progress,No treatment,
                           Failed first treatment, Failed second treatment" style="dropdown"/>
                  </td>
              </tr>

              <tr>
                  <td class="label">Details:</td>
                  <td>
                      <obs conceptId="161011" field='tuberculosis_comments' id='tuberculosis_comments'  style="textarea" rows="3" cols="40"/>
                  </td>
              </tr>

          </table>

      </section>
    </span>

    <span id="S14">
      <section headerLabel="14. TB Screening">

          <table class="baseline-aligned">
                <tr><td><b>TB Screening Results:</b></td></tr>
                <tr><td>TB Contact:<obs conceptId="124068"/></td></tr>
                <tr><td><br/><b>Respiratory Symptoms</b></td></tr>
                <tr><td><obs conceptId="1628" answerConceptId='159799' answerLabel='Cough Lasting More than 2 weeks' style='checkbox'/></td></tr>
                <tr><td><obs conceptId="1628" answerConceptId="138905" answerLabel="Hemoptysis" style="checkbox"/></td></tr>
                <tr><td><obs conceptId="1628" answerConceptId="122496" answerLabel="Dyspnea" style="checkbox" /></td></tr>
                <tr><td><br/><b>Constitutional/B-Symptoms</b></td></tr>
                <tr><td><obs conceptId="1628" answerConceptId="1494" answerLabel="Fever for more than 3 weeks" style="checkbox" /></td></tr>
                <tr><td><obs conceptId="1628" answerConceptId="1479" answerLabel="Night Sweats more than 3 weeks " style="checkbox" /></td></tr>
                <tr><td><obs conceptId="1628" answerConceptId="150796" answerLabel="Noticeable weight loss " style="checkbox" /></td></tr>
                <tr><td><obs conceptId="1628" answerConceptId="120749" answerLabel="Chest pain and breathlesness" style="checkbox" /></td></tr>
                <tr><td><obs conceptId="1628" answerConceptId="135488" answerLabel="Swollen lymphnodes (Neck, armpit, groin)" style="checkbox" /></td></tr>
                <tr><td><obs conceptId="1628" answerConceptId="5312" answerLabel="Swollen joints" style="checkbox" /></td></tr>
          </table>

      </section>
    </span>


     <span id="S15">
      <section headerLabel="15. TB Prophylaxis">

          <table class="baseline-aligned">

              <tr>
                  <td class="label">Tuberculosis Prophylaxis Plan:</td>
                  <td>
                      <obs conceptId="1265" style="dropdown" id='tuberculosis_prophylaxis_plan' required='true'/> Reason: <obs id="reason_tb_proph_changed" conceptId="162152"/>
                  </td>
              </tr>

              <tr id="reasonTuberculosisProphylaxisStoppedDropdown_row">
                  <td class="label">Reason Tuberculosis Prophylaxis Stopped:</td>
                  <td>
                      <obs id="reason_tb_proph_stopped" conceptId="1266"/>
                  </td>
              </tr>
              <tr>
                  <td class="label">Tuberculosis prophylaxis (isoniazid) started:</td>
                  <td>
                      <obs conceptId="1264" answerConceptIds="1065,1066" style='radio'/>
                  </td>
              </tr>
              <tr>
                  <td class="label">Patient reported current Tuberculosis Prophylaxis: </td>
                  <td>
                      <obs conceptId="1110"/>
                  </td>
              </tr>

          </table>

      </section>
    </span>



<section>
    <span class="majorSection"><center><h3>Social Risk Factors and Prevention</h3></center></span>
</section>


    <span id="S16">
      <section headerLabel="16. Family Planning">

        <div class="enableDisable">
            <table id="trigger">
                <tr>
                    <td class="nested-td" colspan="3">
                        <obs field="FP_some" conceptId="5271" style="checkbox" labelText="Currently using some form of family planning"/>
                    </td>
                </tr>
            </table>
            <table id="disabled">
                <tr>
                    <td><br/></td>
                </tr>
                <tr>
                    <td class="nested-td">
                        <obs field="FP_rhythm" conceptId="374" answerConceptId="5277" answerLabel="Fertility awareness/Natural Family Planning"/>
                    </td>
                    <td class="nested-td">
                        <obs field="FP_lactational" conceptId="374" answerConceptId="136163" answerLabel="Lactational Amenorrhea"/>
                    </td>
                </tr>
                <tr>
                    <td><br/></td>
                </tr>
                <tr>
                    <td class="nested-td">
                        <obs field="FP_con" conceptId="374" answerConceptId="190" answerLabel="Condoms"/>
                    </td>
                    <td class="nested-td">
                        <obs field="FP_cap" conceptId="374" answerConceptId="5278" answerLabel="Diaphragm / Cervical Cap"/>
                    </td>
                    <td class="nested-td">
                        <obs field="FP_injection" conceptId="374" answerConceptId="5279" answerLabel="Injectable Hormones (progesterone derivative)"/>
                    </td>
                </tr>
                <tr>
                    <td class="nested-td">
                        <obs field="FP_iud" conceptId="374" answerConceptId="5275" answerLabel="Intrauterine Device"/>
                    </td>

                    <td class="nested-td">
                        <obs field="FP_pill" conceptId="374" answerConceptId="780" answerLabel="Oral Contraceptive Pill"/>
                    </td>
                    
                    <td class="nested-td">
                        <obs field="FP_ster" conceptId="374" answerConceptId="5276" answerLabel="Sterilization / Hysterectomy"/>
                    </td>
                </tr>
                <tr>
                    <td class="nested-td">
                        <div class="enableDisable">

                            <div id="trigger">
                                <obs field="FP_other" conceptId="374" answerConceptId="5622" answerLabel="Other"/>
                            </div>
                            <div id="disabled" class="secondary">
                                <obs field="FP_specify" id="FP_specify" conceptId="161011" style="textarea" rows="3" cols="20" labelText="Specify :"/>
                            </div>
                        </div>
                    </td>
                </tr>
            </table>
        </div>

          <br/>
          <br/>

          <table class="baseline-aligned">

              <tr>
                  <td class="label">Reason for no Family Planning: </td>
                  <td>
                      <obs conceptId="160575"/>
                  </td>
              </tr>
              <tr>
                  <td class="label">If contraceptive given, please select type/method</td>
                  <td>
                      <obs conceptId="160576"/>
                  </td>
              </tr>
              <tr>
                  <td class="label">Was family planning education given?</td>
                  <td>
                      <obs conceptId="162128" style='checkbox'/>
                  </td>
              </tr>
              <tr>
                <td class="label">Comments:</td>
                <td>
                    <obs field="FP_comments" id="FP_comments" conceptId="161011" style="textarea" rows="3" cols="20" />
                </td>
            </tr>

          </table>


      </section>
    </span>



     <span id="S17">
      <section headerLabel="17. At-Risk Population">
            <table>
                <tr>
                    <td class="nested-td">
                        HIV Risk Factor: <obs conceptId="160581" id='hiv_risk_factor' required="true" answerConceptIds="160580,6096,105,160578,1064,160579"/>
                    </td>
                </tr>
            </table>
      </section>
    </span>


     <span id="S18">
      <section headerLabel="18. PWP Services">

          <table class="baseline-aligned">

              <tr>
                  <td class="label">Has PwP counselling been provided?</td>
                  <td>
                      <obs conceptId="161595" id='pwp_counselling_provided' required='true' answerConceptIds="159777,161593,1066,1914"/>
                  </td>
              </tr>

              <tr>
                  <td class="label">Has the client been given condoms this visit?</td>
                  <td>
                      <obs conceptId="159777" style="radio" id='given_condoms' required='true' answerConceptIds="1066,1065"/>
                  </td>
              </tr>

              <tr>
                  <td class="label">Has preventative counselling been provided?</td>
                  <td>
                      <obs conceptId="1914" style="radio" id='preventative_counselling' required='true' answerConceptIds="1066,1065"/>
                  </td>
              </tr>

              <tr>
                  <td class="label">Has the client been screened for STI (in this visit)?</td>
                  <td>
                      <obs conceptId="161558" style="radio" id='sti_screening' required='true' answerConceptIds="1066,1065"/>
                  </td>
              </tr>

              <tr>
                  <td class="label">Has the Client disclosed HIV status to their sexually active partner?</td>
                  <td>
                      <obs conceptId="159423" style="radio" id='hiv_status_disclosure' required='true' answerConceptIds="1066,1065"/>
                  </td>
              </tr>

              <tr>
                  <td class="label">Has the client's partner received HIV testing?</td>
                  <td>
                      <obs conceptId="161557" style="radio" id='client_partner_onsite' required='true' answerConceptIds="1066,1065"/>
                  </td>
              </tr>
              <tr>
                  <td class="label">Has counselling been provided to couples to prevent HIV Transmission?</td>
                  <td>
                      <obs conceptId="162088" style="radio" id='hiv_transmission_prevention' required='true' name="hiv_counselling"/>
                  </td>
              </tr>
          </table>

      </section>
    </span>

<span id="Referrals">

    <section headerLabel="Referrals">

        <table>
            <tr>
                <td>

                    <h4>Referrals Made:</h4>

                    <repeat>
                        <template>
                            <table>
                                <tr id="{n}-toggleContainer" style="display:none;">

                                    <td class="nested-td">
                                        <obs id="{n}-list" field="REFER_{n}" conceptId="1272" style="dropdown"/>
                                        Location: <obs id="{n}-list" field="REFER_loc{n}" conceptId = "1272" answerClasses="KMRI_Locations" style="dropdown" showCommentField="true" />
                                    </td>
                                    <td class="nested-td"><button id="{n}-addEntry" class="addEntry">Add</button><button id="{n}-removeEntry" class="removeEntry">Remove</button></td>
                                </tr>
                            </table>
                        </template>
                        <render n="101"/>
                        <render n="102"/>
                        <render n="103"/>
                        <render n="104"/>
                        <render n="105"/>
                        <render n="106"/>
                        <render n="107"/>
                        <render n="108"/>
                        <render n="109"/>
                        <render n="110"/>
                    </repeat>
                </td>
            </tr>
        </table>
    </section>
</span>
<section>
    <span class="majorSection"><center><h3>Diagnosis</h3></center></span>
</section>

     <span id="S19">
      <section headerLabel="19. Diagnosis">
<h4>    WHO</h4>
			<table class="baseline-aligned" style="none">

              <tr>
                  <td class="label">WHO Stage: </td>
                  <td colspan="4">
                      <obs conceptId="160553" answerConceptIds="1204,1205,1206,1207"
                           answerLabels="Stage 1 (Adult),Stage 2 (Adult),Stage 3 (Adult),Stage 4 (Adult)"
                           style="radio"/>
                  </td>
              </tr>


              <tr>
                  <td class="label">Opportunistic Infections: </td>
                  <td class="spaced-out-td">
                      <obs conceptId="6048" answerConceptId="5334" answerLabel="Candidiasis Oral"/>
                  </td>
                  <td class="spaced-out-td">
                      <obs conceptId="6048" answerConceptId="5340" answerLabel="Candidiasis Oral or Oesophageal"/>
                  </td>
                  <td class="spaced-out-td">
                      <obs conceptId="6048" answerConceptId="5018" answerLabel="Chronic Diarrhoea"/>
                  </td>
                  <td class="spaced-out-td">
                      <obs conceptId="6048" answerConceptId="5035" answerLabel="CMV Disease"/>
                  </td>
                  
                  
              </tr>

              <tr>
                  <td class="label"></td>
                  <td class="spaced-out-td">
                      <obs conceptId="6048" answerConceptId="990" answerLabel="CNS Toxoplasmosis"/>
                  </td>
                  <td class="spaced-out-td">
                      <obs conceptId="6048" answerConceptId="5033" answerLabel="Cryptococcal Meningitis"/>
                  </td>
                  <td class="spaced-out-td">
                      <obs conceptId="6048" answerConceptId="5345" answerLabel="Encephalopathy"/>
                  </td>
                  <td class="spaced-out-td">
                      <obs conceptId="6048" answerConceptId="5042" answerLabel="Extrapulmonary Tuberculosis"/>
                  </td>
              </tr>

              <tr>
                  <td class="label"></td>
                  <td class="spaced-out-td">
                      <obs conceptId="6048" answerConceptId="5344" answerLabel="Herpes Simplex"/>
                  </td>
                  <td class="spaced-out-td">
                      <obs conceptId="6048" answerConceptId="5329" answerLabel="Herpes Zoster"/>
                  </td>
                  <td class="spaced-out-td">
                      <obs conceptId="6048" answerConceptId="5041" answerLabel="Lymphoma"/>
                  </td>
                  <td class="spaced-out-td">
                      <obs conceptId="6048" answerConceptId="5043" answerLabel="Non-TB Mycobacteria"/>
                  </td>                  
              </tr>

              <tr>
                  <td class="label"></td>
                  <td class="spaced-out-td">
                      <obs conceptId="6048" answerConceptId="5046" answerLabel="PML"/>
                  </td>
                  <td class="spaced-out-td">
                      <obs conceptId="6048" answerConceptId="882" answerLabel="Pneumocystis Carinii Pneumonia (PCP)"/>
                  </td>
                  <td class="spaced-out-td">
                      <obs conceptId="6048" answerConceptId="5338" answerLabel="Pulmonary Tuberculosis"/>
                  </td>
                  <td class="spaced-out-td">
                      <obs conceptId="6048" answerConceptId="823" answerLabel="Wasting"/>
                  </td>
              </tr>
              <tr>
                <td class="label"></td>
                  <td class="spaced-out-td" colspan="4">
                      <obs conceptId="6048" answerConceptId="1215" answerLabel="Recurrent Pneumonia"/>
                  </td>
              </tr>

              <tr>
                <td class="label">Comments:</td>
                <td>
                    <obs field="OI_1" id="OI_1"  conceptId="161011" style="textarea" rows="3" cols="20" />
                </td>
            </tr>

			</table>
          
          <br/>
          <b>Reportable Diagnoses:</b>

          <repeat>
            <template>
                <table>
                    <tr id="{n}-toggleContainer" style="display:none;">
                        <td class="nested-td">
                            <span class="required">*</span><obs id="{n}-list" field="REPDIAG_{n}" conceptId="1284" answerClasses="RequiredDiagnosis" showCommentField="true" style="dropdown"/>
                        </td>
                        <td class="nested-td"><button id="{n}-addEntry" class="addEntry">Add</button><button id="{n}-removeEntry" class="removeEntry">Remove</button></td>
                    </tr>
                </table>
            </template>
            <render n="1"/>
            <render n="2"/>
            <render n="3"/>
            <render n="4"/>
            <render n="5"/>
            <render n="6"/>
            <render n="7"/>
            <render n="8"/>
            <render n="9"/>
            <render n="10"/>
            <render n="11"/>
            <render n="12"/>
            <render n="13"/>
            <render n="14"/>
            <render n="15"/>
            <render n="16"/>
            <render n="17"/>
            <render n="18"/>
            <render n="19"/>
            <render n="20"/>
            <render n="21"/>
            <render n="22"/>
            <render n="23"/>
            <render n="24"/>
            <render n="25"/>
            <render n="26"/>
            <render n="27"/>
            <render n="28"/>
            <render n="29"/>
            <render n="30"/>
            <render n="31"/>
            <render n="32"/>
            <render n="33"/>
            <render n="34"/>
            <render n="35"/>
            <render n="36"/>
            <render n="37"/>
            <render n="38"/>
            <render n="39"/>
            <render n="40"/>
            <render n="41"/>
            <render n="42"/>
            <render n="43"/>
            <render n="44"/>
          </repeat>

          <b> Diagnoses: </b>
          <repeat>
            <template>
                <table>
                    <tr id="{n}-toggleContainer" style="display:none;">
                        <td class="nested-td">
                            <obs id="{n}-list" field="DIAG_{n}" conceptId="1284" answerClasses="Diagnosis" showCommentField="true" style="autocomplete"/>
                        </td>
                        <td class="nested-td"><button id="{n}-addEntry" class="addEntry">Add</button><button id="{n}-removeEntry" class="removeEntry">Remove</button></td>
                    </tr>
                </table>
            </template>
            <render n="401"/>
            <render n="402"/>
            <render n="403"/>
            <render n="404"/>
            <render n="405"/>
            <render n="406"/>
            <render n="407"/>
            <render n="408"/>
            <render n="409"/>
            <render n="410"/>

          </repeat>
          <br />

			Next scheduled Appointment Date?
			<obs field="nextappointmentdate" id="nextappointmentdate" conceptId="5096" allowFutureDates="true" allowPastDates="false"> </obs>
      </section>

              
    </span>

<span id="testspan" style="display:none;">
    <obs field="ugh1" id="addedDiagnosisCount" conceptId="161649" />
    <obs field="ugh4" id="addedDiagCount" conceptId="161737"/>
    <obs field="ugh3" id="addedReferralsCount" conceptId="161652"/>
    <obs field="ugh8" id="addedReferralsReceivedCount" conceptId="162045"/>
</span>

<submit id="submitButton"/>
</htmlform>